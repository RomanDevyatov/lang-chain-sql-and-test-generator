You are a senior data engineer.

Input table schema:
{raw_schema}

Generate PostgreSQL SQL that:

Creates or replaces a view named {view_name}.

The view must aggregate per user:

- total_revenue = sum of revenue for purchase events
- total_events = count of all events
- avg_revenue_per_event = total_revenue divided by total_events

Rules:

- PostgreSQL compatible
- Use GROUP BY
- Avoid window functions
- Include simple comments
- Handle division by zero safely
- Output only SQL (no markdown, no backticks)
