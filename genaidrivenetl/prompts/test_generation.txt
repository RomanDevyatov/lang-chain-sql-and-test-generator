You are a senior data quality engineer.

Here is the PostgreSQL ETL SQL that creates the staging view:

{sql_logic}

The SQL creates or replaces a view named {view_name}.

Pytest loads this view into a pandas DataFrame fixture named {fixture_name}.

Generate pytest tests that validate the business correctness of this view.

Required checks:

- total_revenue is not null and >= 0
- total_events > 0
- avg_revenue_per_event >= 0
- no duplicate user_id rows

Rules:

- Use only user_metrics_df fixture
- Do not access database
- Do not define fixtures
- Output only plain Python code
- No markdown, no backticks, no explanations
